{% set name = "rubin-sim-all" %}
{% set version = "2.4.0" %}
{% set python_min = "3.10" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/lsst/rubin_sim/archive/refs/tags/v{{ version }}.tar.gz
  sha256: cc22ad88e9c88a244308083ecae0e88f9e32dc9420f38b0df337d22a64adf0dd

build:
  number: 0

outputs:
  - name: rubin_sim
    version: {{ version }}
    build:
      noarch: python
    requirements:
      host:
        - python {{ python_min }}
      run:
        - python >={{ python_min }}
        - {{ pin_subpackage('rubin-sim', exact=True) }}
    test:
      imports:
        - rubin_sim
      requires:
        - python {{ python_min }}

  - name: rubin-sim
    version: {{ version }}
    script: run_sim_build.sh
    build:
      noarch: python
    requirements:
      host:
        - python {{ python_min }}
        - pip
        - setuptools
        - setuptools_scm >=8.0
        - setuptools_scm_git_archive
      run:
        - python >={{ python_min }}
        - astropy-base
        - astroplan
        - colorcet
        - cycler
        - gitpython
        - healpy
        - h5py
        - matplotlib-base
        - numpy
        - numexpr
        - pandas
        - pyarrow
        - pytables
        - rubin-scheduler >=3.8
        - scipy
        - shapely
        - skyfield >=1.52
        - skyproj
        - sqlalchemy
        - tqdm
    test:
      imports:
        - rubin_sim
      commands:
        - rs_download_data --help
      requires:
        - python {{ python_min }}

about:
  home: https://github.com/lsst/rubin_sim
  license: GPL-3.0-only
  license_file: LICENSE
  summary: Scheduler, survey strategy analysis, and other simulation tools for Rubin Observatory.

extra:
  recipe-maintainers:
    - roceb
    - tribeiro
    - rhiannonlynne
    - beckermr
    - yoachim
